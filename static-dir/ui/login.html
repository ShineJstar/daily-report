<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta property="qc:admins" content="354537152576306614576375741141525072471645060454" />
    <title>DailyReport</title>
    <style type="text/css">
    body{
        font-size: 12px;
    }
    </style>
</head>
<body>
    <div id="login"></div>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="conf.js"></script>
    <script type="text/javascript">
        document.title = get_system_title();
        
        function require_login(){
            // 应用的APPID
            var appID = get_qq_oauth_app_id();
            // 成功授权后的回调地址
            var redirectURI = get_qq_oauth_redirect_url();
            // 透传的状态
            var state = get_qq_oauth_state();
            
            var path = 'https://graph.qq.com/oauth2.0/authorize?';
            var queryParams = ['client_id=' + appID,
                'redirect_uri=' + redirectURI,
                'scope=' + 'get_user_info', 
                'response_type=token',
                'state=' + state];

            var query = queryParams.join('&');
            var url = path + query;
            //console.log(url);
            $("#login").empty();
            $("#login").append("Welcome to " + get_system_title() + "!<br/>");
            $("#login").append("<a href='" + url + "'><img src='login.png'/></a>");
            //window.location.href = url;
        }
        
        if(enable_auth()){
            require_login();
        }
        else{
            $("#login").html("Welcome to " + get_system_title() + "!<br/>");
            if (use_angularjs) {
                $("#login").append('<a href="../angularjs/ng_index.html#/submit">提交日报</a><br/>');
            } else {
                $("#login").append('<a href="submit.html">提交日报</a><br/>');
            }
        }
    </script>
</body>
